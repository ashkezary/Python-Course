# جلسه هجدهم (کار با داده‌ها)

## ژوپیتر نوت‌بوک
تا اینجای درس برای کدنویسی پایتون از IDEهایی مانند 
<mark class=yellow>VS Code </mark>
یا 
<mark class=yellow>Pycharm </mark>
استفاده می‌کردیم و نحوه کارمان نیز این طور بود که یک کد کامل را می‌نوشتیم و سپس آن را اجرا می‌کردیم و برنامه خط به خط تا انتها برایمان اجرا می‌شد. یک امکان دیگری که در پایتون وجود دارد این است که برنامه را به صورت تکه‌تکه بنویسیم و هربار هر تکه‌ای را که نیاز داشتیم اجرا کنیم. مثلاً فرض کنید در یک برنامه کتابخانه سنگینی را فراخوانی کرده‌اید و بعد با قراردادن یک مقدار اولیه، برنامه را اجرا می‌کنید. حال اگر بخواهید با یک مقدار اولیه دیگر، برنامه را بیازمایید در شیوه‌ی سابق، لازم است که کل برنامه را دوباره اجرا کنید. کدنوشتن به صورت تکه تکه مسائلی از این دست را برایمان ساده‌تر می‌کند. یک محیط برنامه‌نویسی که امکان کدنوشتن تکه‌ای را فراهم می‌کند، ژوپیتر نوت‌بوک است. برای نصب ژوپیتر نوت‌بوک کافی است دستور زیر را در ترمینال اجرا کنید:
```bash
pip install notebook
```
البته برای استفاده از ژوپیتر حالت‌های دیگری مانند `Jupyter Lab` و `Anaconda` نیز وجود دارند و حالت ساده ترمینالی `ipython` نیز بخشی از امکانات ژوپیتر را در اختیارمان می‌گذارد اما تمرکز ما روی ژوپیتر نوت‌بوک است. لازم به ذکر است که غیر از نصب روی سیستم، این امکان نیز وجود دارد که از محیط `Google Colab` استفاده کنید.

در محیط ژوپیتر، علاوه بر مورد ذکر شده، می‌توان از `Markdown` و `HTML` نیز استفاده کرد. ویژگی متمایزکننده دیگر ژوپیتر نوت‌بوک این است که روی مرورگر و به حالت سروری بالا می‌آید. ما در این درس برای کار با داده‌ها از این IDE استفاده می‌کنیم. منظور ما از تحلیل داده در این درس، فقط تحلیل داده‌های صفحه گسترده (یعنی فایل‌های xlsx. و csv. و مانند این‌ها) است. به طور ساده و بدون امکانات ویژه، می‌توانیم با آنچه در مورد فایل‌ها آموختیم، این کار را انجام دهیم اما برای بهینه‌تر بودن، از کتابخانه‌های `pandas` و `numpy` و `matplotlib` استفاده خواهیم کرد. اولی را در این جلسه توضیح می‌دهیم و دو مورد دیگر را در جلسه بعد. لازم به ذکر است که این کتابخانه‌ها به صورت پیش‌فرض همراه پایتون نیستند و به همین خاطر باید به کمک `pip` آن‌ها را نصب کرد.

نکته. در اجرای هر سلول ژوپیتر، اگر در خط آخر مقداری را برگردانیم یا چیزی بگذاریم، در صورتی که قابل نمایش باشد، ژوپیتر آن را نشان می‌دهد. مثلاً اگر سطر آخر یک سلول فقط نام یک متغیر را بنویسیم، بدون اینکه از `print` استفاده کرده باشیم، مقدار آن چاپ می‌شود. در مثال‌هایی که در ادامه هم می‌آید، علت اینکه از `print` استفاده نشده همین است.

## کتابخانه‌ی pandas
برای خواندن، نگهداری و پردازش بهینه‌ی داده‌های جدولی، اولین گزینه‌ی مناسب کتابخانه‌ی `pandas` است. این کتابخانه به کمک داده‌ساختار `dataframe` این داده‌ها را نگه داشته و امکان کردن به طور بهینه را فراهم می‌کند. عموماً این کتابخانه را به صورت `import pandas as pd` فراخوانی می‌کنند. روشن است که همه کدهایی که پس از این می‌آیند، نیاز دارند که این خط کد پیشتر برایشان اجرا شده باشد. 

در ادامه، مهم‌ترین امکانات کتابخانه pandas را با هم مرور می‌کنیم:

### خواندن داده
با دستور `read_csv` و `read_excel` می‌توانیم به ترتیب فایل‌های csv و xlsx را بخوانیم.
```python
df = pd.read_csv("file address")
```
### فهم اولیه از داده
وقتی جدولی را می‌خوانیم، برای رسیدن به یک تصویر کلی از داده، موارد زیر می‌توانند راهگشا باشند:

۱- دیدن چند سطر نخست
```python
df.head()
```
۲- دیدن نام همه ستون‌ها
```python
df.columns
```
۳- دیدن نوع داده هر ستون و تعداد مقادیر تهی هر ستون
```python
df.info()
```
۴- تحلیل آماری مقدماتی برای ستون‌های عددی

تابع `describe` کمینه، بیشینه، میانگین و چارک‌های هرستون داده‌ای را نشان می‌دهد.
```python
df.describe()
```

### مدیریت سطر و ستون
برای دیدن یک ستون به طور خاص، می‌توان از دستور زیر استفاده کرد:
```python
df['colname']
```
علاوه بر این می‌تواند دستورهای `max` و `min` و `mean` و مانند این‌ها را به طور مستقیم روی همین تک ستون اجرا کرد. برای مثال:
```python
df['colname'].min()
```
برای گزینش، ستون‌ها یا سطرهای خاص می‌توانیم به شکل زیر و با استفاده از یک متغیر بولی درون `[]` داده‌ها را فیلتر کنیم:
```python
df[df['Country']=='Ireland']
```
یا مثلاً:
```python
df[df['number']>50]
همچنین اگر بخواهیم تغییری روی مقادیر یک ستون انجام دهیم، می‌توانیم با استفاده از تابع `apply` این کار را انجام دهیم:
```python
def to_title(s):
    return s.title()
df['names'] = df['names'].apply(to_title)
```
دقت کنید تابعی که استفاده می‌کنید باید طوری باشد که انگار روی یک مقدار از آن ستون اجرا می‌شود. برای مثال، در نمونه بالا، چون می‌دانستیم که ستون 'names` مقادیرش همه رشته هستند، تابعی را که پیشتر برای یک رشته نوشته بودیم، روی اعضای آن اعمال کردیم.

اگر بخواهیم مقادیر غیرتکراری (یکتای) یک ستون را ببینیم می‌توانیم از دستور `df['col'].unique()` استفاده کنیم و اگر بخواهیم ببینیم از هر مقدار چندتا در ستون موردنظر هست، دستور `df['col'].value_counts()` به ما کمک می‌کند.

برای دیدن یک سطر مشخص هم می‌توان از دستور `df.iloc()` استفاده کرد.

برای حذف کردن یک سطر یا ستون نیز می‌توان به شکل زیر از دستور `drop` استفاده کرد:
```python
#Delete Row(s)
df.drop([row_indices])
#Delete Column(s)
df.drop([colnames], axis = 1)
```
توجه کنید که برای حذف ستون باید مقدار `axis` را برابر 1 قرار داد.
### مدیریت مقادیر تهی
گاهی در ضبط داده‌ها ممکن است به علت کمبود اطلاعات یا بی‌دقتی، به میزان کم یا زیاد مقادیر تهی وجود داشته باشد. بسته به نوع مسأله، می‌توان تصمیم گرفت که این داده‌ها را حذف یا با مقداری مناسب جایگزین کرد. کتابخانه pandas برای کار با مقادیر تهی، دو تابع `dropna` و `fillna` را دارد که می‌توان آن‌ها را روی کل دیتافریم یا روی یک ستون مشخص اعمال کرد.

### همبستگی

برای اینکه ببینیم ستون‌های عددی چقدر به هم مرتبط‌اند و به هم وابسته‌اند، می‌توانیم به سادگی از دستور زیر استفاده کنیم:
```python
df.corr()
```
